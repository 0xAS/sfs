%
\documentclass{article}

% Encoding of the file
\usepackage[utf8]{inputenc}

% Font: computer modern bright
%\usepackage{cmbright}

% math packages
\usepackage{amsmath,amssymb,MnSymbol}

%\usepackage[T1]{fontenc}
%\usepackage{amsfonts}

\title{Driving Functions for the Spectral Devision Method}

%\graphicspath{{figs/}}

% Include some macros from external file
\include{macros}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{document}

\maketitle

The wave field in the $x$-$y$-plane is given for a linear array by
\begin{equation}
    P(\x,\omega) = - \int^{\infty}_{-\infty} D(\x_0,\omega)
    G_\threeD(\xx,\omega) dx_0
    \qc
    \label{eq:P}
\end{equation}
where $\x = \binom{x}{y}$ with $y>0$ and $\x_0 = \binom{x_0}{0}$. The
functions $D(\cdot)$ and $G_\threeD(\cdot)$ denote the
secondary source driving signal and the wave field emitted by the secondary
sources, respectively.
As can be seen easily the given integral is a spatial convolution along the
$x$-axis.
Hence the convolution theorem of the Fourier transform holds and it is
\begin{equation}
    \tilde{P}(k_x,y,\omega) = \tilde{D}(k_x,\omega) \tilde{G}(k_x,y,\omega)
    \gq
\end{equation}
The prospected driving function is then given by
\begin{equation}
    \tilde{D}(k_x,\omega) =
    \frac{\tilde{P}(k_x,y,\omega)}{\tilde{G}(k_x,y,\omega)}
    \gq
\end{equation}

In SDM spatial
source models for the virtual sources are used to calculate the driving
function. Typical source models such as plane or spherical waves are used. The 
\textit{SFS analysis} directory contains functions to simulate the wave field
for the three different source models for a plane wave, a point source, and a
focused source which is a point source located in the listening area.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Plane Waves}
The source model for a point source is given by [Williams]:
\begin{equation} 
    S(\x,\omega) = 
    \hat{S}_\text{s}(\omega)
    e^{i\omegac \vec{n}_k \x}
    \qc
\end{equation}
where $\hat{S}_\text{s}(\omega)$ denotes the frequency spectrum of the plane
wave and $\vec{n}_k$ the direction of $\vec{k}$, which is the direction of the
plane wave.

Using \EqRef{eq:D} and \EqRef{eq:D_25D} this leads to a driving function of:
\begin{equation}
    D_\twohalfD(\x_0,\omega) = \hat{S}_\text{s}(\omega)
    2 g_0 n_{ky_0} \sqrt{\frac{\omega}{ic}}
    e^{i\omegac \vec{n}_k \x_0}
    \qp
    \label{Dpw}
\end{equation}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Point Sources}
The source model for a point source is given by [Williams]:
\begin{equation} 
    S(\x,\omega) = 
    \hat{S}_\text{s}(\omega)
    \frac{1}{4\pi} \frac{e^{i\omegac|\x-\x_\text{s}|}}{|\x-\x_\text{s}|}
    \qc 
\end{equation}
where $\hat{S}_\text{s}(\omega)$ denotes the frequency spectrum of the point
sink and $\x_\text{s} = \binom{x_\text{s}}{y_\text{s}}$ the position of the
point source with $y_\text{s} < 0$.
Using \EqRef{eq:D} and \EqRef{eq:D_25D} this leads to a driving function of:
\begin{equation}
    D_\twohalfD(\x_0,\omega) = \hat{S}_\text{s}(\omega)
    \frac{g_0}{2\pi}
    \left( \sqrt{\frac{\omega}{ic}} - \sqrt{\frac{ic}{\omega}} 
    \frac{1}{|\x_0-\x_\text{s}|} \right)
    \frac{y_0-y_\text{s}}{|\x_0-\x_\text{s}|^{2}} 
    e^{i\omegac|\x_0-\x_\text{s}|}
    \qp
    \label{eq:Dps}
\end{equation}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Focused Sources}

For the synthesis of a focused source, a synthesized wave field is desired which
converges towards a focus point and diverges after passing the focus point.
This is given by a point sink [Williams]:
\begin{equation} 
    S(\x,\omega) = 
    \hat{S}_\text{s}(\omega)
    \frac{1}{4\pi} \frac{e^{-i\omegac|\x-\x_\text{s}|}}{|\x-\x_\text{s}|}
    \qc 
\end{equation}
where $\hat{S}_\text{s}(\omega)$ denotes the frequency spectrum of the point
sink and $\x_\text{s} = \binom{x_\text{s}}{y_\text{s}}$ the position of the
focused source with $y_\text{s} > 0$.
Using \EqRef{eq:D} and \EqRef{eq:D_25D} this leads to a driving function of:
\begin{equation}
    D_\twohalfD(\x_0,\omega) = -\hat{S}_\text{s}(\omega)
    \frac{g_0}{2\pi}
    \left( \sqrt{\frac{\omega}{ic}} + \sqrt{\frac{ic}{\omega}} 
    \frac{1}{|\x_0-\x_\text{s}|} \right)
    \frac{y_0-y_\text{s}}{|\x_0-\x_\text{s}|^{2}} 
    e^{-i\omegac|\x_0-\x_\text{s}|}
    \qp
    \label{eq:Dfs}
\end{equation}
In \FigRef{fig:WFS} the wave field $P(\vec{x},\omega)$ for
a monochromatic focused
source located at $\vec{x}_\text{s} = \binom{0}{1}$ is simulated. The secondary
source distribution is located at the $x$-axis. The wave field converges for
$0<y<1$\,m towards the position of the focused source and diverges for $y>1$\,m
which defines the listening area for the given focused source position.

If the driving function \EqRef{eq:Dfs}
is transferred into the temporal domain,
it is given as
\begin{equation}
    d_{\text{2.5D}}(\x_0,t) = -s(t) * h(t) *
    \frac{g_0}{2\pi}
    \frac{y_0 - y_\text{s}}{|\x_0-\x_\text{s}|^{2}}
    \;\delta\left(t + \frac{|\x_0-\x_\text{s}|}{c}\right)
    \qc
\label{eq:d}
\end{equation}
where $c$ is the speed of sound and
$h(t)$ denotes the inverse Fourier transformation
\begin{equation} 
    h(t) =
    \IFT{\biggl\{ \sqrt{\frac{\omega}{ic}} + \sqrt{\frac{ic}{\omega}}
    \frac{1}{|\x_0-\x_\text{s}} \biggr\}} 
    \qp
    \label{eq:h}
\end{equation}

\end{document}
