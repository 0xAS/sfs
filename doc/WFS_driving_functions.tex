%
\documentclass{article}

% Encoding of the file
\usepackage[utf8]{inputenc}

% Font: computer modern bright
%\usepackage{cmbright}

% math packages
\usepackage{amsmath,amssymb,MnSymbol}

%\usepackage[T1]{fontenc}
%\usepackage{amsfonts}

\title{Driving Functions in Wave Field Synthesis}

%\graphicspath{{figs/}}

% Include some macros from external file
\include{macros}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{document}

\maketitle

The wave field in the $x$-$y$-plane is given for a planar array by
\begin{equation}
    P(\x,\omega) = - \int^{\infty}_{-\infty} D_\twoD(\x_0,\omega)
    G_\twoD(\xx,\omega) dx_0 dz_0
    \qc
    \label{eq:P}
\end{equation}
where $\x = (x,y,z)$ with $y>0$ and $\x_0 = (x_0,0,z_0)$. The
functions $D_\twoD(\cdot)$ and $G_\twoD(\cdot)$ denote the
secondary source driving signal and the wave field emitted by the secondary
sources, respectively.
In WFS the driving function is given as
\begin{equation}
    D_\twoD(\x_0,\omega) = 2 \p{y} S(\x,\omega) \Big\vert_{\x = \x_0}
    \qc
    \label{eq:D}
\end{equation}
where $S(\cdot)$ denotes the wave field of the desired virtual source.
In applications with cabinet loudspeakers as secondary sources the
dimensional mismatch of a 3D secondary source ($G_\threeD$)
for 2D reproduction has to be
considered. This leads to a so called 2.5D driving functions which applies
an amplitude correction to reduce this mismatch.
Using a far-field approximation ($\omegac|\xx| \gg 1$) the following
relationship between the two dimensional line source and the three dimensional
point source can be derived [Zitat fuer Hankelnaehrung, Williams?]:
\begin{equation}
    \underbrace{
        \frac{i}{4} \hankelone{0}\left(\omegac |\xx|\right)
    }_{G_\twoD(\xx,\omega)}
    \approx 
    \sqrt{2\pi \frac{ic}{\omega} |\xx|}\;\;
    \underbrace{
        \frac{1}{4 \pi} \frac{e^{i\omegac|\xx|}}{|\xx|}
    }_{G_\threeD(\xx,\omega)} \qp
\label{eq:2D_Green_approx}
\end{equation}
This results in the so called 2.5D driving function, which is given with
\EqRef{eq:2D_Green_approx} as
\begin{equation}
    D_\twohalfD(\x_0,\omega) = \\ 
        \sqrt{ \frac{ic}{\omega} } \;
        \underbrace{\sqrt{2\pi|\x_\text{ref}-\x_0|}}_{g_0} \;
        D_\twoD(\x_0,\omega) \qc 
\label{eq:D_25D}
\end{equation}
where $g_0$ is a geometry dependent constant [Zitat]. It is obvious, that
$g_0$ can be chosen in a way, that the amplitude is correct at a line at
$y_\text{ref}$ parallel to the loudspeaker array.

The synthesized wave field in the $x$-$y$-plane is then given for a linear array
by
\begin{equation}
    P(\x,\omega) = - \int^{\infty}_{-\infty} D_\twohalfD(\x_0,\omega)
    G_\threeD(\xx,\omega) dx_0
    \qc
    \label{eq:P}
\end{equation}
where now $\x = (x,y)$ and $\x_0 = (x_0,0)$.

In model-based WFS spatial
source models for the virtual sources are used to calculate the driving
function. Typical source models such as plane or spherical waves are used. The 
\texttt{SFS\_monochromatic} directory contains functions to simulate the wave
field
for monochromatic sources. The \texttt{SFS\_time\_domain} directory contains
functions to simulate the wave field for a impulse. The
\texttt{SFS\_binaural\_resynthesis} directory contains function to create a BRIR
signal for listening by headphones for the desired loudspeaker array.
All those functions are able to use three different source models for their
driving functions: the model for
a plane wave, a point source, and a focused source which is a point source
located in the listening area.
The driving functions are presented in the following sections.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Plane Waves}
The source model for a plane wave is given by [Williams, S.21, eq. 2.24]:
\begin{equation} 
    S(\x,\omega) = 
    \hat{S}_\text{s}(\omega)
    e^{i\omegac \vec{n}_k \x}
    \qc
\end{equation}
where $\hat{S}_\text{s}(\omega)$ denotes the frequency spectrum of the plane
wave and $\vec{n}_k$ the direction of $\vec{k}$, which is the direction of the
plane wave.
Using \EqRef{eq:D} and \EqRef{eq:D_25D} this leads to a driving function of
\begin{equation}
    D_\twohalfD(\x_0,\omega) = \hat{S}_\text{s}(\omega)
    2 g_0 n_{ky_0} \sqrt{\frac{\omega}{ic}}
    e^{i\omegac \vec{n}_k \x_0}
    \qp
    \label{Dpw}
\end{equation}

If we use the Fourier transfomation we will get as the driving function for the
time domain
\begin{equation}
    d_\twohalfD(\x_0,t) = s(t) * h(t) * 2 g_0 n_{ky_0} \delta(t +
    \frac{\vec{n}_k \x_0}{c})
    \qc
    \label{dpw}
\end{equation}
where $h(t) = \IFT{\left\{ \sqrt{\frac{\omega}{ic}} \right\}}$.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Point Sources}
The source model for a point source is given by [Williams]:
\begin{equation} 
    S(\x,\omega) = 
    \hat{S}_\text{s}(\omega)
    \frac{1}{4\pi} \frac{e^{i\omegac|\x-\x_\text{s}|}}{|\x-\x_\text{s}|}
    \qc 
\end{equation}
where $\hat{S}_\text{s}(\omega)$ denotes the frequency spectrum of the point
sink and $\x_\text{s} = \binom{x_\text{s}}{y_\text{s}}$ the position of the
point source with $y_\text{s} < 0$.
Using \EqRef{eq:D} and \EqRef{eq:D_25D} this leads to a driving function of:
\begin{equation}
    D_\twohalfD(\x_0,\omega) = \hat{S}_\text{s}(\omega)
    \frac{g_0}{2\pi}
    \left( \sqrt{\frac{\omega}{ic}} - \sqrt{\frac{ic}{\omega}} 
    \frac{1}{|\x_0-\x_\text{s}|} \right)
    \frac{y_0-y_\text{s}}{|\x_0-\x_\text{s}|^{2}} 
    e^{i\omegac|\x_0-\x_\text{s}|}
    \qp
    \label{eq:Dps}
\end{equation}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Focused Sources}

For the synthesis of a focused source, a synthesized wave field is desired which
converges towards a focus point and diverges after passing the focus point.
This is given by a point sink [Williams]:
\begin{equation} 
    S(\x,\omega) = 
    \hat{S}_\text{s}(\omega)
    \frac{1}{4\pi} \frac{e^{-i\omegac|\x-\x_\text{s}|}}{|\x-\x_\text{s}|}
    \qc 
\end{equation}
where $\hat{S}_\text{s}(\omega)$ denotes the frequency spectrum of the point
sink and $\x_\text{s} = \binom{x_\text{s}}{y_\text{s}}$ the position of the
focused source with $y_\text{s} > 0$.
Using \EqRef{eq:D} and \EqRef{eq:D_25D} this leads to a driving function of:
\begin{equation}
    D_\twohalfD(\x_0,\omega) = -\hat{S}_\text{s}(\omega)
    \frac{g_0}{2\pi}
    \left( \sqrt{\frac{\omega}{ic}} + \sqrt{\frac{ic}{\omega}} 
    \frac{1}{|\x_0-\x_\text{s}|} \right)
    \frac{y_0-y_\text{s}}{|\x_0-\x_\text{s}|^{2}} 
    e^{-i\omegac|\x_0-\x_\text{s}|}
    \qp
    \label{eq:Dfs}
\end{equation}
In \FigRef{fig:WFS} the wave field $P(\vec{x},\omega)$ for
a monochromatic focused
source located at $\vec{x}_\text{s} = \binom{0}{1}$ is simulated. The secondary
source distribution is located at the $x$-axis. The wave field converges for
$0<y<1$\,m towards the position of the focused source and diverges for $y>1$\,m
which defines the listening area for the given focused source position.

If the driving function \EqRef{eq:Dfs}
is transferred into the temporal domain,
it is given as
\begin{equation}
    d_{\text{2.5D}}(\x_0,t) = -s(t) * h(t) *
    \frac{g_0}{2\pi}
    \frac{y_0 - y_\text{s}}{|\x_0-\x_\text{s}|^{2}}
    \;\delta\left(t + \frac{|\x_0-\x_\text{s}|}{c}\right)
    \qc
\label{eq:d}
\end{equation}
where $c$ is the speed of sound and
$h(t)$ denotes the inverse Fourier transformation
\begin{equation} 
    h(t) =
    \IFT{\biggl\{ \sqrt{\frac{\omega}{ic}} + \sqrt{\frac{ic}{\omega}}
    \frac{1}{|\x_0-\x_\text{s}} \biggr\}} 
    \qp
    \label{eq:h}
\end{equation}

\end{document}
